<div class="mt-4">
    <h3>Khóa học của tôi</h3>
    <a href="/courses/create">Đăng khóa học</a>
    <a href="/me/trash/courses">Thùng rác ({{deletedCount}})</a>
    <div class="row">
        <table class="table">
            <thead>
                <tr>
                <th scope="col">#</th>
                <th scope="col">Tên khóa Học</th>
                <th scope="col">Mô tả</th>
                <th scope="col" colspan="2" class="text-center">Action</th>
                </tr>
            </thead>
            <tbody>
                {{#each courses}}
                    <tr>
                        <th scope="row">{{sum @index 1}}</th>
                        <td>{{this.name}}</td>
                        <td>{{this.description}}</td>
                        <td>
                            <a class="btn btn-link" href="/courses/{{this._id}}/edit" role="button">Sửa</a>
                        </td>
                        <td>
                            <a class="btn btn-link" href="/courses/delete" role="button" data-toggle="modal" data-target="#modal-delete" data-id="{{this._id}}">Xóa</a>
                        </td>
                    </tr>
                {{else}}
                  <tr>
                    <td colspan="5" class="text-center">
                      Bạn chưa có khóa học nào. <a href="/courses/create">Đăng khóa học</a>
                    </td>
                  </tr>
                {{/each}}
            </tbody>
            </table>
        
            
    </div>
</div>


{{!-- Modal confirm delete --}}

<div id="modal-delete" class="modal fade" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Xóa khóa học?</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Bạn chắc chắn muốn xóa khóa học?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
        <button type="button" class="btn btn-danger" id="modal-delete-btn" >Xóa bỏ</button>
      </div>
    </div>
  </div>
</div>

{{!-- Form hidden delete --}}
<form id="delete-course-form" method="POST" ></form>

<script>
    document.addEventListener("DOMContentLoaded", function(e) {
        let courseId;
        const deleteForm = document.getElementById('delete-course-form');
        const deleteBtn = document.getElementById('modal-delete-btn');

        $('#modal-delete').on('show.bs.modal', function (event) {
            var button = $(event.relatedTarget);
            var id = button.data('id');
            console.log(button)
            courseId = id;
        })

        deleteBtn.onclick = function (e) {
            deleteForm.action = `/courses/${courseId}?_method=DELETE`;
            deleteForm.submit();
        }

    })
</script>
